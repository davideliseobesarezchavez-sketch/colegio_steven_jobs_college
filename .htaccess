# ======================================================
# üöÄ SISTEMA ESCOLAR - URLs limpias y seguras
# ======================================================

RewriteEngine On
RewriteBase /colegio_steven_jobs_college/

# ================================
# üîê Redirigir ra√≠z al login
# ================================
RewriteCond %{REQUEST_URI} ^/colegio_steven_jobs_college/?$ [NC]
RewriteRule ^$ login [L,R=302]

# =======================================================
# üß© Eliminar extensi√≥n .php en la ra√≠z
# (Ejemplo: /login ‚Üí /login.php)
# =======================================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9_-]+)/?$ $1.php [L,QSA]

# =======================================================
# ‚ú® Rutas limpias dentro de /index/
# (Ejemplo: /index/index_admin ‚Üí /index/index_admin.php)
# =======================================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^index/([a-zA-Z0-9_-]+)/?$ index/$1.php [L,QSA]

# =======================================================
# ü™Ñ Redirecci√≥n especial:
# /index/registro ‚Üí /registro.php (archivo en ra√≠z)
# =======================================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^index/registro/?$ registro.php [L,QSA]

# =======================================================
# ü™Ñ Redirecci√≥n adicional (opcional):
# /index/crear_cuenta ‚Üí /crear_cuenta.php
# /index/recuperar_contrase√±a ‚Üí /recuperar_contrase√±a.php
# =======================================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^index/(crear_cuenta|recuperar_contrase√±a)/?$ $1.php [L,QSA]

# =======================================================
# ‚ú® Rutas limpias para /includes/
# (Ejemplo: /includes/actualizar_tarea ‚Üí /includes/actualizar_tarea.php)
# =======================================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^includes/([a-zA-Z0-9_-]+)/?$ includes/$1.php [L,QSA]

# =======================================================
# üõ°Ô∏è Proteger carpetas internas
# =======================================================
RewriteRule ^(PHPMailer-master|vendor|config)/ - [F,L]

# =======================================================
# üö´ Bloquear archivos sensibles
# =======================================================
<FilesMatch "(^\.|config\.php|conexion\.php)">
  Require all denied
</FilesMatch>

# =======================================================
# üåê Evitar listado de directorios
# =======================================================
Options -Indexes

# =======================================================
# ‚úçÔ∏è Forzar codificaci√≥n UTF-8
# =======================================================
AddDefaultCharset utf-8
